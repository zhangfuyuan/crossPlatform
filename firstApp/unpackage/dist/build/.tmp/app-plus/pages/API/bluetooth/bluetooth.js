(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/API/bluetooth/bluetooth"],{"1e39":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{title:"bluetooth",disabled:[!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],newDeviceLoad:!1,searchLoad:!1,maskShow:!1,equipment:[],adapterState:{discovering:!1,available:!1},connected:!1,showMaskType:"device",servicesData:[],characteristicsData:[],valueChangeData:{},isStop:!0,list:[]}},onLoad:function(){this.onBLEConnectionStateChange()},methods:{moveHandle:function(){},maskclose:function(){this.maskShow=!1},queryDevices:function(){this.showMaskType="device",this.maskShow=!0},tapQuery:function(e){"device"===this.showMaskType&&(this.$set(this.disabled,4,!1),this.equipment.length>0?this.equipment[0]=e:this.equipment.push(e),this.newDeviceLoad=!1),"service"===this.showMaskType&&(this.$set(this.disabled,6,!1),this.servicesData.length>0?this.servicesData[0]=e:this.servicesData.push(e)),"characteristics"===this.showMaskType&&(this.$set(this.disabled,7,!1),this.characteristicsData.length>0?this.characteristicsData[0]=e:this.characteristicsData.push(e)),this.maskShow=!1},openBluetoothAdapter:function(){var t=this;e.openBluetoothAdapter({success:function(e){console.log("初始化蓝牙成功:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:212"),console.log(JSON.stringify(e)," at pages\\API\\bluetooth\\bluetooth.vue:213"),t.isStop=!1,t.$set(t.disabled,0,!0),t.$set(t.disabled,1,!1),t.$set(t.disabled,10,!1),t.getBluetoothAdapterState()},fail:function(e){console.log(e," at pages\\API\\bluetooth\\bluetooth.vue:221"),console.log("初始化蓝牙失败，错误码："+(e.errCode||e.errMsg)," at pages\\API\\bluetooth\\bluetooth.vue:222"),0!==e.errCode&&s(e.errCode,e.errMsg)}})},startBluetoothDevicesDiscovery:function(){var t=this;e.startBluetoothDevicesDiscovery({success:function(e){console.log("开始搜索蓝牙设备:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:235"),t.searchLoad=!0,t.$set(t.disabled,1,!0),t.$set(t.disabled,2,!1),t.$set(t.disabled,3,!1),t.onBluetoothDeviceFound()},fail:function(e){console.log("搜索蓝牙设备失败，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:243"),0!==e.errCode&&s(e.errCode)}})},stopBluetoothDevicesDiscovery:function(t){var o=this;e.stopBluetoothDevicesDiscovery({success:function(e){console.log("停止搜索蓝牙设备:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:256"),t?o.$set(o.disabled,1,!0):o.$set(o.disabled,1,!1),o.$set(o.disabled,2,!0),o.searchLoad=!1},fail:function(e){console.log("停止搜索蓝牙设备失败，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:267"),0!==e.errCode&&s(e.errCode)}})},onBluetoothDeviceFound:function(){var t=this;e.onBluetoothDeviceFound(function(e){console.log("开始监听寻找到新设备的事件"," at pages\\API\\bluetooth\\bluetooth.vue:279"),t.getBluetoothDevices()})},getBluetoothDevices:function(){var t=this;e.getBluetoothDevices({success:function(e){t.newDeviceLoad=!1,console.log("获取蓝牙设备成功:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:291"),t.list=e.devices},fail:function(e){console.log("获取蓝牙设备错误，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:296"),0!==e.errCode&&s(e.errCode)}})},getBluetoothAdapterState:function(){var t=this;console.log("---\x3e"," at pages\\API\\bluetooth\\bluetooth.vue:307"),e.getBluetoothAdapterState({success:function(e){console.log(JSON.stringify(e)," at pages\\API\\bluetooth\\bluetooth.vue:310"),t.adapterState=e},fail:function(e){console.log("获取本机蓝牙适配器状态失败，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:314"),0!==e.errCode&&s(e.errCode)}})},createBLEConnection:function(){var t=this,o=this.equipment[0].deviceId;e.showToast({title:"连接蓝牙...",icon:"loading",duration:99999}),e.createBLEConnection({deviceId:o,success:function(o){console.log(o," at pages\\API\\bluetooth\\bluetooth.vue:335"),console.log("连接蓝牙成功:"+o.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:336"),t.stopBluetoothDevicesDiscovery(!0),e.hideToast(),e.showToast({title:"连接成功",icon:"success",duration:2e3}),t.$set(t.disabled,3,!0),t.$set(t.disabled,4,!0),t.$set(t.disabled,5,!1),t.$set(t.disabled,9,!1),t.connected=!0},fail:function(e){console.log("连接低功耗蓝牙失败，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:352"),0!==e.errCode&&s(e.errCode)}})},closeBLEConnection:function(){var t=this,o=this.equipment[0].deviceId;e.closeBLEConnection({deviceId:o,success:function(e){console.log(e," at pages\\API\\bluetooth\\bluetooth.vue:367"),console.log("断开低功耗蓝牙成功:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:368"),t.$set(t.disabled,1,!1),t.$set(t.disabled,3,!0),t.$set(t.disabled,4,!0),t.$set(t.disabled,5,!0),t.$set(t.disabled,6,!0),t.$set(t.disabled,7,!0),t.$set(t.disabled,8,!0),t.$set(t.disabled,9,!0),t.equipment=[],t.servicesData=[],t.characteristicsData=[]},fail:function(e){console.log("断开低功耗蓝牙成功，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:382"),0!==e.errCode&&s(e.errCode)}})},getBLEDeviceServices:function(){var t=this,o=this.equipment[0].deviceId;console.log("获取所有服务的 uuid:"+o," at pages\\API\\bluetooth\\bluetooth.vue:394"),e.getBLEDeviceServices({deviceId:o,success:function(e){console.log(JSON.stringify(e.services)," at pages\\API\\bluetooth\\bluetooth.vue:400"),console.log("获取设备服务成功:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:401"),t.$set(t.disabled,7,!0),t.$set(t.disabled,8,!0),t.showMaskType="service",t.list=e.services,t.characteristicsData=[],t.list.length<=0?a("获取服务失败，请重试!"):t.maskShow=!0},fail:function(e){console.log("获取设备服务失败，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:415"),0!==e.errCode&&s(e.errCode)}})},getBLEDeviceCharacteristics:function(){var t=this,o=this.equipment[0].deviceId,i=this.servicesData[0].uuid;console.log(o," at pages\\API\\bluetooth\\bluetooth.vue:428"),console.log(i," at pages\\API\\bluetooth\\bluetooth.vue:429"),e.getBLEDeviceCharacteristics({deviceId:o,serviceId:i,success:function(e){console.log(JSON.stringify(e)," at pages\\API\\bluetooth\\bluetooth.vue:436"),console.log("获取特征值成功:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:437"),t.$set(t.disabled,7,!0),t.valueChangeData={},t.showMaskType="characteristics",t.list=e.characteristics,t.list.length<=0?a("获取特征值失败，请重试!"):t.maskShow=!0},fail:function(e){console.log("获取特征值失败，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:449"),0!==e.errCode&&s(e.errCode)}})},onBLEConnectionStateChange:function(){var t=this;e.onBLEConnectionStateChange(function(e){if(console.log("蓝牙连接状态 --------------------------\x3e"," at pages\\API\\bluetooth\\bluetooth.vue:462"),console.log(JSON.stringify(e)," at pages\\API\\bluetooth\\bluetooth.vue:463"),!e.connected){if(t.isStop)return;console.log("断开低功耗蓝牙成功:"," at pages\\API\\bluetooth\\bluetooth.vue:466"),t.$set(t.disabled,1,!1),t.$set(t.disabled,3,!0),t.$set(t.disabled,4,!0),t.$set(t.disabled,5,!0),t.$set(t.disabled,6,!0),t.$set(t.disabled,7,!0),t.$set(t.disabled,8,!0),t.$set(t.disabled,9,!0),t.searchLoad=!1,t.equipment=[],t.servicesData=[],t.characteristicsData=[],t.valueChangeData={},a("已经断开当前蓝牙连接")}})},readBLECharacteristicValue:function(){var t=this,o=this.equipment[0].deviceId,a=this.servicesData[0].uuid,i=this.characteristicsData[0].uuid;console.log(o," at pages\\API\\bluetooth\\bluetooth.vue:491"),console.log(a," at pages\\API\\bluetooth\\bluetooth.vue:492"),console.log(i," at pages\\API\\bluetooth\\bluetooth.vue:493"),e.readBLECharacteristicValue({deviceId:o,serviceId:a,characteristicId:i,success:function(e){console.log("读取设备数据值成功"," at pages\\API\\bluetooth\\bluetooth.vue:502"),console.log(JSON.stringify(e)," at pages\\API\\bluetooth\\bluetooth.vue:503"),t.notifyBLECharacteristicValueChange()},fail:function(e){console.log("读取设备数据值失败，错误码："+e.errCode," at pages\\API\\bluetooth\\bluetooth.vue:507"),0!==e.errCode&&s(e.errCode)}}),this.onBLECharacteristicValueChange()},onBLECharacteristicValueChange:function(){var t=this;e.onBLECharacteristicValueChange(function(e){console.log("监听低功耗蓝牙设备的特征值变化事件成功"," at pages\\API\\bluetooth\\bluetooth.vue:521"),console.log(JSON.stringify(e)," at pages\\API\\bluetooth\\bluetooth.vue:522"),t.valueChangeData=e})},notifyBLECharacteristicValueChange:function(){var t=this.equipment[0].deviceId,o=this.servicesData[0].uuid,s=this.characteristicsData[0].uuid,a=this.characteristicsData[0].properties.notify;console.log(t," at pages\\API\\bluetooth\\bluetooth.vue:534"),console.log(o," at pages\\API\\bluetooth\\bluetooth.vue:535"),console.log(s," at pages\\API\\bluetooth\\bluetooth.vue:536"),console.log(a," at pages\\API\\bluetooth\\bluetooth.vue:537"),e.notifyBLECharacteristicValueChange({state:!0,deviceId:t,serviceId:o,characteristicId:s,success:function(e){console.log("notifyBLECharacteristicValueChange success:"+e.errMsg," at pages\\API\\bluetooth\\bluetooth.vue:547"),console.log(JSON.stringify(e)," at pages\\API\\bluetooth\\bluetooth.vue:548")}})},closeBluetoothAdapter:function(t){var o=this;e.closeBluetoothAdapter({success:function(e){console.log("断开蓝牙模块成功"," at pages\\API\\bluetooth\\bluetooth.vue:558"),o.isStop=!0,o.$set(o.disabled,0,!1),o.$set(o.disabled,1,!0),o.$set(o.disabled,2,!0),o.$set(o.disabled,3,!0),o.$set(o.disabled,4,!0),o.$set(o.disabled,5,!0),o.$set(o.disabled,6,!0),o.$set(o.disabled,7,!0),o.$set(o.disabled,8,!0),o.$set(o.disabled,9,!0),o.$set(o.disabled,10,!0),o.equipment=[],o.servicesData=[],o.characteristicsData=[],o.valueChangeData={},o.adapterState=[],o.searchLoad=!1,a("断开蓝牙模块")}})}}};function s(e,t){switch(e){case 1e4:a("未初始化蓝牙适配器");break;case 10001:a("未检测到蓝牙，请打开蓝牙重试！");break;case 10002:a("没有找到指定设备");break;case 10003:a("连接失败");break;case 10004:a("没有找到指定服务");break;case 10005:a("没有找到指定特征值");break;case 10006:a("当前连接已断开");break;case 10007:a("当前特征值不支持此操作");break;case 10008:a("其余所有系统上报的异常");break;case 10009:a("Android 系统特有，系统版本低于 4.3 不支持 BLE");break;default:a(t)}}function a(t){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.showModal({title:"提示",content:t,showCancel:o})}t.default=o}).call(this,o("6e42")["default"])},6296:function(e,t,o){"use strict";var s=o("8d2c"),a=o.n(s);a.a},"8d2c":function(e,t,o){},"940b":function(e,t,o){"use strict";var s=function(){var e=this,t=e.$createElement;e._self._c},a=[];o.d(t,"a",function(){return s}),o.d(t,"b",function(){return a})},afec:function(e,t,o){"use strict";o.r(t);var s=o("940b"),a=o("e3f6");for(var i in a)"default"!==i&&function(e){o.d(t,e,function(){return a[e]})}(i);o("6296");var l=o("2877"),c=Object(l["a"])(a["default"],s["a"],s["b"],!1,null,null,null);t["default"]=c.exports},e3f6:function(e,t,o){"use strict";o.r(t);var s=o("1e39"),a=o.n(s);for(var i in s)"default"!==i&&function(e){o.d(t,e,function(){return s[e]})}(i);t["default"]=a.a}},[["5c8f","common/runtime","common/vendor"]]]);